---
title: "R Notebook"
output: html_notebook
---

#Lê dados
require(readr);
contratos <- read_csv("dados/author.csv");
contratos <- contratos[1:500,]

#Gera corpus para a coluna Objeto
require(quanteda)
corpus <- corpus(contratos, text_field = "text")

#Gera tokens
tokens <- tokens_tolower(tokens(corpus))

tokens <- tokens_select(tokens, stopwords('en'), selection = "remove")


#Gera dfm
dfm <- dfm(tokens, tolower = FALSE, remove_punct = TRUE, stem = TRUE)

#Gera estatística
textstat <- textstat_frequency(dfm, n = 6)
head(textstat)

#Gera indice TFIDF
indice_tfidf <- data.frame(dfm_tfidf(dfm))
indice_tfidf <- indice_tfidf[,-1] 

require(e1071)
require(caret)

#Extrai coluna Modalidade da Licitação
autores <- data.matrix(contratos$'author')

#Converte para numérico
autores <- as.factor(autores);

#Define porcentagem dos dados para treino
treino <- createDataPartition(y=autores,p = .5)$Resample1

#Executa SVM
modelo <- svm(x=indice_tfidf[treino,], y=autores[treino])
predicoes <- predict(modelo, indice_tfidf[-treino,])
confusionMatrix(predicoes, autores[-treino])